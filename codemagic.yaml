workflows:
  android-workflow:
    name: Android Workflow
    max_build_duration: 120
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmhFTjM4VlNZaWozQXVSNVFEM2pleHpVRTZHNlpiTUN3WTZDcVpLMWRCY3RzWlljQ2NYenBVdmJpRmNYZ2l1SUU5VkgxRkJvOGdmbVNPYnR2LXpEeEs3cXgyU19fZVN0cDctMmpxdXRBelM2NjB3ZjFTaU01bzFlcmhrdUtlOERYR21LWlVUY3Jac0xMZmdhQndsVDZDNDBwUm5jNkhCdm5oWmxnV0FSOUVBeXRGOVRfcVlHcTlpVV94NGgxZGhLbndsRkFnbnVFZFNCUlp4bDdDVjNSeVhPOEkxU3BPNXFZY19HNmIyWldrWFVWdHdGNVluM3hGcDZGdWRYVm9IY1BYak9fLWhMVHNTU3Fua2Nvdm9MV21OMlNzN0lfR1JIV3BaeGM2T25QSERzem5JaUxNMWdYMURnc2M5dHI2a2ZnWkVFQk9uQm9yTFJBS0R5aGZBM3RqZjViVm9rc3B0ZUcxM0Ffc3FKMHRWWW9yN3NaLXhXWG5CajR3d0x0SXFEdkVkcVRRelpWQWwwQWFVRl9lYmMtTUpWNzhZa1NoOWxrNXRlbE4zaHpMN2U3ZVBWY1RzX3VUT21YNkR1Q0NOdzZKN3RGX3BQMHJOOUtpaFJLb3Awa2hwSnBwczlGXzhrWm1vZzJveG93TVc5alpUWC1YMTNsbWFndTVmNmg2UlFZaHNCdWJMNExiRHltWWxPN25NbFJsdy1fODY4VmpmS3B5SFR4cHRmZUZuVHkwRFVUd3RNVnA1WTRmeGg1RDhDSGMzRkNqVXpGdDNqR2JRTE90cFNDNzdoZjBvU1MtaWt4c1BkQmpTQkdXVi1laEhwSWlUcUUzOU1mWkl5VU1NOEJXWFRGMU1RVDFsb09TbEcxbUhpaUU3MWVDOFRhUmNsNjVjSUtrOXNXc3Z6OGpZc1NDbktVNDB6T3UzbDhmZmJsTUttTUFsVF9EWEVNZzFReHdMT3Z5ZlF6YTJJQ241Sktfa0tiVHpYeERoTTYwTF8yREpYUjd3WlJjSTFxUFYxQnV4NUo5TldwVkh1SXZxNkpyQ25VZXFfSzZVeDhSQlBOV0FBeERoZjg1dzY0WmhGZmFSYW9zaGRxNkwzYlVsR3hpakF4OHV3V1JkanBLTnQyVkFyZDJNeGtVT0pKdllicWtsYjNrOUF3QTFrbEFQYXVoZ2liR0RnRWVkQVpHYWhxR2I4bDhhY2hxUV9ZeS13MFdvcWp0WVZMUnR3aTBENTVlTEZtMWZ6RzZMMG9fbmMzeXR0cmhybmJJUzBRUzBYWXR6UkYtOEZnQ09SM0lJQ1pPOTZiV2R5Ti1qOHVyWUoxc3RUMHctYTFRV0gwSGRqMGZUR0VDNUZWYjhOcEZmTTFLZDVqSUdQMU93TWMtZDBDNFktUVhYMUxZdTlyajFidTV0bmw2UmRFSzZUbXNCekhveFVxeFJFTmN5clhNS20yaWVERnpVZzZybEVjSjNramdYV1VBZ0JHamNiaEUySEd4YjNqcWRxbW03WGNIa3lPOTBJVHVRYjhJTXAxTXByZDIxcVRtUERFT091SHJnUTlNMVlwc212TTVDSjhIVVo1WVdOc0Zoejc2OEQyQXJSWkU5YmFhdEhYV2R1b1Rjb29OR2dyZ3piTnd0ckxsT0k2SEh3dTdOMFhuZjZvWmdFaVRYaTlHY2dvOEwwUkR5OV9lRzVKLXU4eE14S0EyN2stNEFIUWY0QWlOdEIxUTJYVXZ6b1JGdm5uZVEzTmt1N09oclcyNnJwdWQxUFFyUHkzQVdFQW1VYmFyRUh1SmsydGQ4QURiWjRrdkN3QnEwQ3FHWlRyQjVkcE81NHBoeGpTVjRiXzB2dlp1Szd4ekM0QnhLZllZa0g5LWpPMFJCM2tIN25KeGRVemtzclZESDRKcXdyWFRWRUdVMm1zOUZuWGQzYWxQeXJXelhsajJwZ1FhTUFGVi14WFFRV3pQeDNneWNNZ0NsZl9ROFI3cU9STTREckRQMW1oSWhVN1d5UWFzT180NGhXcTNVNWpGM3p0ZnlHQnFwbkR5Qk0wdFRXTFdkdWxIV3RhRFNCQ0tpRUxQRk50R3o0eDZHVGRPc2tzNjcwS0RBVHp4RXlzQXBrX2VwMFEyenNCZUVXX3k2eUFGVzBBZFhkSHRXQ2lpOF9RVkdUV3pzU0FhWFFvQURKU0RhSEpNSkh6c0tjTjY1QjRxbkVZUThSMThBX0RZcDJ6WV81RXZGTE03Qlp1V25GLVlBd0RuMFVzQTJnMFg0bmU3elpmcHJ0N08taW1reHdSZlBXUkE5S1NxdTJ0Y1FFT0VIeU5HeWZCOTlEbGVOcVJ5X3RwdUY0OGhJMkhxSWRZaXotS1JBZzk3Zk9IZmIyYWlrSFJSbmNpem5BMHZkbW5Qd010TFgyVlZHS3Jxd1JQbG1NQ2MtTUdSeTFwMUFiVGJjTG05M2d6dDF2N1BQTHZUcFBZamU3LXpLN3dsM1hjWHduX2duSXlSVTB3S2kycmJ0V2FtMUJLbkE3aTdNclhLRWZpQlZJS1RrUHpKVnpjVnJKWEVoekNsMkhXMWhNWjBCenBleTRxYVVGUVZkSjA3VUJ1dUNsQ3lRNjMtZVNoU1BhbHhGdU9BdHhVQmVoYzczOXR6TnZYMnRiU0hVTTRDVWM0RUY5YW5LcnprYk1LMFRzNWVGdW9BajViWmRDTjdQX0wzNTN0NjNJdDVSaW91LTlHb0xhZnhYTVhzQnYtaEF0ZE8teGhIRXZ1d3Q4ZlphbE1wSlVLT2dSVTdNdHAybjIxYUx3UGptVHBrdXU0RmtTZ0hWQ3dyMm5oeXVOdXpuSi10TlNHdVNDcTlPcjFBZmdPaWNUQ0xEcU44bnJtdVR5RG5iWUVPTnlBZlU5MTVyVER6a1hjRi1NQ1pCSmRXeUdhVVR4OG41TFY3Y2hlMjg0YTJwNzhyOTQ2bWNteFZ3dDM1NGxPUWV3cDlWVHNUTnBLWDZzNlNwYWxkWl9Kd3ptbHhETl84djFFcml6eHhSRjBZNjhsYmN5SXlZaXlPSElCT2NUekI5a3M4T2V4aG5BckNYRWNBVnl4d2VzWm5qbVdsc2NaTjhObG9FSXhMVDI4dUVCTUFtemh6QUVjRUU0Z1hKVHV5SjktQVYtTUwtbnFweUVDNjZJY0k2Ukh6WTZ6VHdKeFVaOEw5eTlWZi1kVXhmMUV6NDVtNENPLTNqUXM5NlFHY3lOWEhzSm1tUVZ6eGxWRkNYLVd0VkVISXpuLUFjWEtIZnJDVTRsUnhsV2dfcTAwaUhOclBBQXRZYnRZUG9QanpHZnhsWHpFaHJGYU9ZWS1XMnFhbXNvM2M4OWh0WlJ2Q2JEZ2hHeUUwLUtTNFdBVFcxNWt2RU5GLU13d2o5RW9aZS1zN24xOWxkYkMtWGFWYV8wZVlIT3prVXRGLUZqVDJsekt4ZVhhTlZ0aU1qbnF1c2JlYkF1dFZjbEtTOEZ0WUM1dWxHLW5CRnRVaDVnTDgyR21kdnBRcDlyRy1Fa05wazVWOF9NZkF0ckkyVHZZYXJaUVFIbmx4THFtV1lzNmkwOS1iZnBIWUlKTElZVzBLM2EyOXo3SUJkLTdOWG9rZ2xzM0FoWERGck9IbUJaY056bHBvTVd0d3FDLWVNQWE0V3llS2dTanQ4RUJhVXkzUmlWanRRQ1Y0MVpyZG93YnNJR3RrcGhDdlRac08tS3VlM0l4anRBTmNNeTR5MG1TaTZCVXV5TEFjOVdObmoycndkY1VER3JDSS1QQ3JaR1N5MjNXWVd1ckEtd0NidHVLcHVydHNtRzZaT1hLY3dLRnFOWV9reWhJV2t6b0V4dEhDOHJ6b2pqcDE1RndCSmFVcXVMTWdUZ2ZZV25QY0l3eEdFcjFaZmpBLTlLYk1YSlpZLW9NQS1MMXc4ZTFHYUc3YklUa3NNZTk1aEhXY0kzUzlsZEphLUUtRVNBU0d1SEp5bTYta0IxcTdRUmo4UDY3Q2ZrR25qOW9vd21RSVNxUVRsTThIa29fakhFaU9aSUxaN1RhU3hZaHIzSDVoTnVmZldiWHBVWjNxOHc4blZtdC0xTDVLcVd2QjNWX2JQaTBqbVNHbEY5T0xWcHhubjhId2VSRm43ZURacE9GTVJ3U2dlM2VPZzFWS1kteF9KdWJ1MlZKVThGVW9WWXYyYWQ2SFhzSkRJaWZNUE9ibG9lYlZMUjBIcUxMSU5LSkRSM2FYaVNDNjlDSEhJN1RCdmlxSlktMS1OVXJVNHN6VEtzRDN1SG5aNUJBRWt5OFhteVUtTVBkSE9rMHdEaGlNM2NraGlOX3lwNUk0QkdjRHVEdlpOSEkzZ3pjTU1ZZTJObkF5S0l2MkVWSll3NEtyVm5CNmZaUEkyX1ZzMTlJWnFURzRPXy1HWmt2b09XREYtV1BBNEdFWEI5NGJqeVI0VF9sS29sZWlvOVpTTkMzQWlQLTlyWlRFU1lLODFzVWR1bTNXa21hc3p6ZE8yemE4cXpjci0zdW5qeWRaTEdTamg3N1NGNDhiektEU1pvX3lpb1VWSjdEamVKcHhWcTJ4MldDbVlLTk9rOFFQM3JRTmFEdk9RWW5oazFFU01CNmhrYy0xcl8zTC0yM0RFcXo4eUpHQjZjOV9KTTB2c1hzRVBzbzhtWV9yV2xzaDB6Nl9ybXhEdnZpQ2tRMGNDNWFfc2VxMDcycjhFOG5XU0tOLUdnUFp5bHgtc2dNeGN0bVd5b1RTcHMtLTFwcFNaWkdrUE85NFVaNFYwMzN3aElrTV9QNUtUX2JHUkt2Wm5NU1dsa0p5dUhMVjFJeThPUHBjZWdPZEo0cnpaeWpzV0JlU1V1R2toUVRZQl81blZOTVpqM1N4cnVMNXBjUm4zRVlBaVRCRVpKa2NBY1JYR3l5UUJtWHYzOWljZXBWb2kzZWd6eWVodGJXRGViWDVrRG9GQTBNRVk1TkIwNkhPeEI1R0FlalJGTGhfZzlnam05MmxFZXFhRDhfTllOXzl6c2J0TVBXclNiSEVPWEl5Q1pIRWxZNHc0NDMwSHo4SjhvMk9OYjE0eXZBaGJ3QnpkT2d0ZU05eU8yLXV2YU40ajl1YnFvdExDWVlMTDk0akNrZkkyX3Z5Y3UxMmVSWDRIcWhYUmJ4Q25DVXJEWUE3UlRIeFBaX3czd0p4SHRSQ3p4YU0xSDRyMUJKSVdpYWw0eXNrNE5MTW0tY05oNWNRejF3bm93NWdyalVSX0pUWUFBYWpKU0VHVHowNzBLMGJ0TUNuN1AzMkxNZHhzOUFNdGdtMVlybWNmcmJxWXJETlpPTWpUTkx0Z3ZtYVQ4UFFYNmlnNkZMaDQyRUktN2hDT05ORzI3STR3UTBVRS1ubVE1QXh4ZG5Ya0hVRUdxTTc5cGlKSmRtRXhLaTlfVV9fcUxaRTBIeV9pUEJwSkpXRlNTUGtYb2FZUklXZkxCTWxFNmFrVXR1aTE2MFcwbzNFRk4xSQ==)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmhFTjJ1SzNnVW5TMElTWEdjcHc4ZDdNY09iREw5Z2JWejBtSmhzY0ViTjVodWxCYzloaHFEOXBxRGlMdDl6RDduV2NIcERab2UwRGNzc1FDU2pGS1NmM083SlE9PQ==) # <-- Put your encrypted key alias here
        PACKAGE_NAME: "com.example.untitled" # <-- Put your package name here  
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up key properties
        script: |
          echo $FCI_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Set up local.properties
        script: |
          echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      - name: Flutter analyze
        script: |
          cd . && flutter analyze
      - name: Flutter unit tests
        script: |
          cd . && flutter test
        ignore_failure: true
      - name: Build APK with Flutter  
        script: |
          cd . && flutter build apk --release
    artifacts:
      - android/app/build/outputs/**/*.aab
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - kalgi@nevercode.io
        notify:
          success: true     # To not receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
