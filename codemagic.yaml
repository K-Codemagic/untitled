workflows:
  android-workflow:
    name: Android Workflow
    max_build_duration: 120
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmhFT0laUlFiM3RKVVpTbS0xYzJIN0JKY2lUMFNJdDJMbWFzaTNOdUFBeU5ocE5UVElKUXRra2w1Q1dQd1pieHp3YVZpcHFvSEtPcVJWTWdrV0FXN3Y4QWRzYUlNTTBTYnVtRC1KZGxkZWJSeGdsOFdWVExMRDU3RWNUd3dyWTV4MzRlVzFVNkx6WGlzTXlYZ1lRR3pLa1F0eWJmeUJoTDN5b3hFWUJiRTQtV0Jhczlfa1R5WTlOZGxNYkp5WjJUR2VZOGxyRnM4b1Y3bUhTakxWQmg5czNMUmRCTzhUZWlHQ0FncGR1UWgwNm1TYndVV0V1dDl5TFJ4bnRjM0dDSjlGRUpkak0xQ2xrVV9rYnFScHl5SnRRVmdxV09kNVJRRTdUQjhrSmVTRE42dktNUXZqNDI5ZC1VOWpEZEMtUDFtYmZ6d2h4bVZYQnkwZEtFYllVSGYyYzFPSk9DRGFXOGxwcTJadF9YeWJ2Rjh0ZE1NSXpNZnNXTXBQZU1lZjlfaVItQlZPam00RzIzVFRtSlRZQTVqYkhOSFVobFhKbWdrWFV3c0F2Rk1CWHdnOTdXd09KUDRtLWFvVG9YUFYxNi1rdXZfa1JnMXE4SDBvM0ppX1gtakF1MDlCQngwYmdMSkVNVlJJZFBicXVoMTZFY0RNNmJYaGpRWDMtNnV0R0lsRXdQTmxzdmZreTR5ellDdGN0ZDlsd09JVm15ZmJMYzFOa1YtNE5ZYjZSVU03VzBHWUpxRDlxeTk2T2YyRmwtd1JlQnB4ZUM2R1UtODhNcDNOYmYxeVRHcjRCa2lNbElacmZsTWQxNFR3ZDYtTmdTa0FUc2tFUlZtemFjMjhXZ3lfN1h6eTBGZkNqdF9NTmw2TjRFN1hhZVpQRmREM2p2cUEtNFJqTUN2N0RTa2hMV1BpTkhISlNOUjhkSmdBb1lsdlRqdmxpWE02RG1tQzJ3b3VDdWtkY3h0S2M2bDgwZjZmWUl2YnBUYW42SVpKbVZYQXFyYVBYTzMteThOMmxuTXM0c3BuLVFCZWxndUxwVlE4YS1vUlVNSk5nN3lYdTcxdE8tN2VUOWdOOUNhSUdnTDBweWt0cjFjSnpfZjZ3TDV4NVZNTXI4TDc5UFcyX1paOHdBREpENEI3UlIzZTN1aC1PdUQtRzJ5TDd0WDZIUGtEVjJXMk90Y0xaVTdlREZCUEpMYUhBcHZVbnVwQzc5UkNaNGNjeEtZaHJ0UnhMbU43WGUzZHdVYkp0UkFabHpQZ3AzRDJmdHNvMVFKQjA5SWhYX3Q3eWhoTURQdXh4dmhsSXpUaTlYTlBDOC1FaEpselpwd192RXhGdDE3YjNMX08tdnFmRHBWcVhBRmZMU3JKZUl5V3pPWXRBbjFMUUthU1ltNVBleW9WRE1ZQXVPSTdoUk9KZlZQeEJNVWtmUkcxWURJb3ZVT25CakFDYTNYeHdxQW5lMVp6R3NsVFV3d2FFZkk5dXA0b1ByczVuMkM3RjB0SzkxelYzNTI0REQ2T1BNWTdkUW1ING9xMWxwaTl1cUpLTVkxa2FUdFF4VXVienI1TDFYR21tU1BGVGxTNnZNMzBOZGl0bTdlMUlrMl9hcm96cWlDTk1uUTBBU25HRlpjUk1kWDRNSFV3TTEwU3hMdlJrZ1U1bnFaRnd2ak4zUk5fMlVKZmh2Yzg3bjJqZTVPbHdQeE1aX3RaeGR2RG1ZakltWFZUR1NJWHVVSzBseHQ1ZzZIczRBYnZIdlJqZVBXWkxHakR1NE1FaVV4bFVPN3hkaEpUVUxSZE5ZcVU1eVVrbXVPUEhULXprdmNYOWR4WXE4ZDZHS1hub0o1VjViOS1YX09lN3ptTXVUS2p4OTcyMk11Q3NXOGREZnc4cUd3eW44NHdPYmx0X2JVOVY0U25IUVRGbk44RnUwQjFlUGZNZnViLWpOZzFGbC1HZXNKSmJ6alFQd0RHV0NXWkVrUENCa3d6VFBoWTkyeWR2bjZxWWUwcmI3dkQtR0JZNEh6bUR0VFlfWE5xeHNQenFjUnFBUnVKdjlsUmFCUU9jc2hsdEhvX3dOdV9zZ183NjRPbVFDdV9vRXdxTkhpQkRPVnhtdm0zeW9WamxNR2hsWlZLcjMyQU1CdWJyQ0FuUVo2QWdkLXBDWW55UzRtYm5CMDVBRlF4T3dJc2JGOXJpV21OdHJ3Rm9ZUnBDUU4za1dNSEhfSVM4cFRFZ1ctTHVFN3A4eGVIckMtbkd4WXVlZ1VLRGdDMElQMUNqMDBrdEE5NVQxeDRqajI5QmJ4My1xUzFGQnVlMU5EWFJEVGllOHJreHBxd253N01yaDhkXzBjZTdJdXowcnZjcUdhVHJSb0MzdXhub3R3dXNyOTl4VnE4Wmd3NFZVRzdIMWItbkJsRWZhMVQ0dVJDam5EY3pMSDZJME95QzdtRGlzN2NpbWZkQUg3RUYxd1RDVGJiWHFMOFlTcjJXMG5KMWpHbXNMdF9WWnVDOThCM0dWWlRxZlFqd0R5WXp4cnZuQWNpd1R3VzI1SmI1elVsSGVGZFpmVGxHTkczTHBiY1FJQVFuaGxJU0M4WFVHb290NnBmMDFxS1B5WElpUU1xaFd4M3h4SWNhNGE1RjZ4NlZsckFFNXRWdG82YUJ3blFleVBnQ2FNTU1UdE5NaEVHSTdzc3JqVzFtS0hIcTVJQ2RwcVVLc2FmeEtLcFRvTmJrNGVUanA2YkhocUFEaGFxRnJmR1lUcTRkanNPLS1tTHA0NDhHZll5UC1IUXJWemFtV3BsUUxIUE1OODdqR3dOMnFUc2VWbDRITGU5aTlQTFFxaFF3aVNURzNmVjdQTnlFNVowT1ZxU3pkY0VUS3ZDUExuWmxaSzlhbjV5MEc2bXNxaGpaRWdWRGlPSnBSSzJ3OUQzTmQ2ZTlMTG9RaWpPZjZzTGpQaWlSRDBRMFFhaWVkUHNlZ205NTlQMll0NHZLa3RJVE01clAtVEtxbndhN0ZzY1RKdG50UXZ2dFcwclJBZEM3bFBjSHhvSUpKRWlOTDR5SzliSjhMQkdyal9zZ1o3cGxYZVVFSm83Q2V4SEVyODlqUXEzSHlDQU9KNmJySkE1STJYOFIwVUpUVEExbFFTQ29ta3l1cmhsU2FSYkZudUpneEw5NXFDbVh4MEx3LXRDckVkOE1XSzBucjdqWHRJR0hoX2V4MU1iSHFuUU5WTEV0ME1zQmplMWF5M3FxZlRtLWdWNER0M1pISmVMSnRrZ2pfOTAtVlIySHRHNUpHVDRVLVV1ZVhuZGFQNGtEd2NMYi1PbVNRZm80TV90eUZRVE5YYnZvOTR1RXJnWTcwZktfTlBmcks4cFZsS1psSWNORm56WWZvM1VxUE1SLVI3cHpzX05mdnBjeTRoZk44YnowdGxSRFU4eWJsejRjbHZPSVFMckdBTGFhZ1ZndlFpY3lYeXFtTWo0ODZ6cFNUeEJXQnh3RWpqWWpWcHdDdzlVcUxYMEdQRTV3bzI2RkE2dHFQckFoRGxYYWk0RDl2M2FmWkE3LWd3Zy1WVXRnR01GVUVrNktHWmI4dUNYcTYwT1ZWMWEwbWRlZXVsOHoxYUxnclBqMkFURmdvaWZjTnFfRFpFSExQcWlLN1dSNTBnaU1XbE9KQmZwTDE1dHVlTXpOTUwybkpNd0gzWEJGaVZZcndiVjZtS3RZTV9hdlhFN0lNMi1xY0ozUVpIcnR2RDFHdVFtOS03VHFYT3JJakdRWXdQRzR2SUtCOWl3SGpBZ3VHU01xWnE2dVdaOXplMHF3OEZKdXJUYjV4bkdaaUk5ZlNPQlhGczdZRVJteG9fRmI5VjNuNFdET296VHRPa3loOG9DWmFnalRSTWR4RzhESHRVdmVRUW9Ld1k0MHYzYzZWOVZNdFFMRWhCR0Z4eEFMTmdCSklERDlWWURMOGk3TU00bGlOWVN3ODJFdnJuSWxxODk3anVDNlVIc3E5THhYQTBUZ0xnTTYwT1JieVZmSnU5QXdkVlBOX0tmTzF2VUZBWHA0ckpoYmUtNEk1SWctdUM3ZXI4eEZCM0hocF93bDE2OVgyRHlMVVNORXJqUGItaGcwa19NcElNTmcxTFRHbVNXbVdXYmZSQkFfNm5YOU80UExXMmljQUljbzZnWXlmanFjNnhab0x3U19HNzFISnRHNFZmVEF2b2F5MjRQUmpqU0RBUEJ2X0VWc0JpaXFTRmM0N2xjYkFhT3lLa1ZJZnhMM1VRQXNQd0Y5M1V5Y2ZaUV9xdkhuVlJ3b2NvVzRQdERLU1hVbThxTDV3ekhZQ1gzaUlkc3U5T1NtMVViMFJPV0E1ZFEwb1c0QVhFR3QzTU5WdkRJQXBmeXBhQjZNbG5sazFpNjAtaXhUUUpaV0V6RkpSa3l6LUgwMlVFWjkxMmM0Q2ROSFVydGRwZmNrSWhYNmNBM2VfMW1CUm8wWWhVVF9iQ1ZKazQ5NGhxZ2FGNURNRFl0VXhjQ005Y2FyaTI4anlvTHRMMkw2dHVpOTFpRnlIb0hMSHg5WmV2VUFHM0pYNzZkQXhwTXQ2Qy1VVmtfVlVxNnltMVZkeXFOa1BpNWNXQjRWMlNmZ05TMEdJcXlzamFqX0p6clp2cmRmY2QxdUM2Yl9oQ2pZeFpEX0dmcERWTE5JTkc3TGZBX2d6cWx0RTktOFdqWE1PQ0Via0ZsM3lOOFdZc1VFdGlFV3ZQYUI1Q0xPQlJiUUtOQlBVSkc4NXFrb1NLUnUtRENOQ0hleGhjbWItbU1iMEsydmxvQmZFZWtKVk5XdXRRY2ZZYVBSUjFnMmtTcmFIUUQ3MGdhR2VrUTJvNFdxdlZsT1hoLXVjY1d3VXVQWXk1MWQwVTRSYzk5dnNqNWdsRlhpWThFUm9MckZuRU1iYURrTHItTV9CSWRKaXZaUFJNOFFVRmFhdnFIdlpwV1J3bWE1Q1h0SVdEbERVa1J4d3Y5YlJiSC1ybGtiX2VnbUNJQUhkZnNrdl9vd0p4Q2RQeHBXRkdGWGEtQjVMd0JsTWdCT2JvLTJiUDZYNkRCRkhQU3NhUnpZWXhtMlBMTmVoeVc5aG9CNDV6WGNnLVc2N1YxTjBPcmQyOTB5TXRHZmpCbDZlMHVPMXk4dHNYTEFsbC0xaUhQZXVHQ1A5Vk9ZTm96NXQ0eDg5alZobGZTU0JDalJSbkhVTmR5dXZCaGxKN2ZlcDlLWUZNMFZ5YzEwdE0wWjlYZUFOZHExNDd6MWloMGtVX1psTGRCclZzUWFCaGsyNlN1bHo2SFpCc2c4RFlyU2ZHWG40a2k3aXg1UTFmQUR5SlhCcWVvS1VVLTZ0d0UzanVMaFVnUjZNYWhTdEhOOFRkbm9MV1hVUVR3ZVdkdVhSUnJEZC1vTXBrNGV1ZEdCeTB3)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmhFTjJ1SzNnVW5TMElTWEdjcHc4ZDdNY09iREw5Z2JWejBtSmhzY0ViTjVodWxCYzloaHFEOXBxRGlMdDl6RDduV2NIcERab2UwRGNzc1FDU2pGS1NmM083SlE9PQ==) # <-- Put your encrypted key alias here
        PACKAGE_NAME: "com.example.untitled" # <-- Put your package name here  
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up key properties
        script: |
          echo $FCI_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Set up local.properties
        script: |
          echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      - name: Flutter analyze
        script: |
          cd . && flutter analyze
      - name: Flutter unit tests
        script: |
          cd . && flutter test
        ignore_failure: true
      - name: Build APK with Flutter  
        script: |
          cd . && flutter build apk --release
    artifacts:
      - android/app/build/outputs/**/*.aab
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - kalgi@nevercode.io
        notify:
          success: true     # To not receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
