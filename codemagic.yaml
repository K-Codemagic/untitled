workflows:
  android-workflow:
    name: Android Workflow
    max_build_duration: 120
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmhELTlMQVhiZGY1aGttOWRURjc2amVNVlJkWjFuQ3k0Y2ZLMEJhX0xXOWJaOFp3Yi1KLUtaZkx3RkRjLXhSNlZTNDhKdFZpWUZNMkQ3MFhmQlhWVFNiRkdSQ245eUZPV3NzazRxZUxnaEJqdW5zZzNISjFSTHBLYS1xaERYcmg4clc4WGlYY0daa0RqWmt6bEZHWjlmb3RMWUgtR0pzSUkzVWlHMTc1S1VrVG41U3EzZVc1NDV1MlNHM09ZR3lnb0dPWk9Xd3FrbUEtalFXc0lFaE56Tm1GdlhTMl9vWDBIby1oNlNEM2RZV2tGWmZhcHNTSUd4U3hENk9fTG0yU0gwMGo1M084LVFqTy1qQkZ2VjR4MlRoRGxELUxoNklpUkFVU0F0cFl5MldUbVBEaGQyR1ZLSnFETXZBSk5rRWFCcWkxLUtObHNmd05RNS1nYnRNNmFlZ3RfZmtJc2hoV1VDY0VDUmtmVk9kQTdDWGVfaVhGeDNmYWY2b1hmNDVzb2MzeU9PTExUMXB0X0N0WGVidjZmYW54U2F4Tk13Zlp2R1A4alp3blR2ZDRmUF90UXlHbFZFcmQ3Sk9mY3gwRmhnLUZ4VXFNUHdSZnRFZV9POGlrYk5IcmNfNm5wVU5aczBhNTB4eklrQXVTd1dFNmxXSUoxRFlBcG51bEt6cTZZMmdxYWE4LXJLYl9yRGJGRTVxQXZycGRGRjJrNlp1QzdTY0tnVkN0YzNmOEp0b1h3YkViSExUZXVRNFdJcGg0dzlyXzNMUEtERGN1bTBMYXM4LVZnT2FpUUNZcmNKRnU4UWxuZHE2bWZWVWFmdGQzNEtsaW1CSHdxQzljUFk3TFUwMC14eFFXZ0lseWpLYnA2eVlDMlVmRVJVNzJNaW43V2JIYklqa2lXVGZCUFJ4QWpUejdNYkZLY0xwSUxVbHdUNnp5SXBYX2loV1ItcjNYLUlQbmFIaG1TSFZiVExadEEzTGtEOXY5cUlIQ1ZKY1M3SzV6ZkRHQXJuNnNXS2dSLVRuY0picEVWcktIZVdjMFpPZVhEQzNUSEMxUm1tWmhZYzl6aFE5Z2Y0aC02YnJENXlhMFJqVVJkTHpiMldDOXlOMzVDRzZzU3FxM1l3bWdvNlZCaU5idUR1b2ZLYmZjTDFPU0xNXzVvRWtDNkhyemZ4eXBSQUtMVWk4MlIxbGVuVmhIUEFRaTlvWnhpVjRkTVhZZDZtYVphMXpqUk1UMW1WaGd1bkE5TWNMYlMyUkJ4bjIxZy1kWnRVMWp0TGF5NE4yS1Zhbm1MMFl0MUlWUmxpU1dSNEpBZk1CUC10UGVtcm8tQWhSRVVLMkllQWRRSDhmWHU1ZmJCakdKd2g0eWpJTW1EWkdiekx0TnJ2ZjNpN1dHT2huZF9PYjg0T1I2bGxsYjg2UnRKQlg5d01ESE9fN1IwYVlyNDdSR3NJVndxTGstdnN5Nk82dlItM2ZXMk9pU0Z4bUx6eExzWFktVUpPWHpobE5FMlBqTkxXSGVHeHg0QnR0d1E1Ml9aWVFjNEFEYkxTcjFteG04YW04VXZycTN5Tm81TlVTYjZIVDJzMzNyaDN2bXMtQ2ZXRTdXeTZjVms0NHQtZkwwVWdKN0lfOGJPZWppZjdtemJqWG1iRFJQRzF3OGtOdkdiZGNzeWhPUkRqdUZ4LTlnX3NjVnVpbmJTZE11b1JJYXpDX0t2SlZSVlFUU0piLUJBX1hGT2ZwTXBzMnJrSnhUajNRb3JQUU42NXdZYUxTa2djOWQwWWN1M0NpVTBXVHlxeTRMMUdpek9UY05GNjlCU1k1X3M3YW13OGR1SkRxR0Y1eFNPOHRLQmZ1Rmc1ZnhlcFMxVjNFV1NtTURLOHlabThCSlRYREVwQy1WbkFhX05pbUNQNDFibzIyNEM5UGVsRHpyV0F3U2FXU2cyc3Q3MDZDSHlPaDI5SEhaNkliWlFob0hsbVFvZW9zNHJ3OXN6dnItVUY3YUdPdVFhTjVtWjRGWnJ1T0xVSFUzTmxGZk5RUW1MRGgwZ3R5WF8yZGE5YTRMRlB6TkRCNVBzUHJWcXIwc2V3WXlaQlg0SjY2Mjg2cWRrdUp4ZjkxYVA4eTNSa1RVcDFhSUQ1b0pOMGZaYUVGZnhZa2dRSkFSdHhJQjd3eGMxYTRWRTFnVEJPRFZSSlA1akV2Q1V3Qkg5Ym96dVhDSlk0RUR0X0VGazR5WC0wTEdsamFvUnBnenZ4aGhhX0d3RXB6WF9OS0NxLW9KaVVDWlZiM0xGaENTTWc4OW5rTVBUbG1SdDMxR0N1NDlCN0xYYU9Uci1KZDJDeXRWaTl1RW44U0FVUDMxR0pIOTMwU1F2Q1l1LV8xVTlkLXZJTEpscC1kd2UwYnZSeWNMQTFVUS12RFp2SWpRRFAxR1pzUHJ3RmpXdHF4U1BSVEtZVXFBVDJTbEtFZHE3RVRQREg1aTdsWDgza0pyaC1aenBSb2tRZHdPM003MjFNbU1fNTFWUFhtZ2R3NGI0RjNVUFF2UVhvSlM0QWFWTWhyYXpLVElJTVJJQW10U1hWUkFVNE9JNmRxYjhmN3piRmNrNmpwbTZadW9yMGFGQms4Mk9fcDAyLXk1NFVYdFR6MU50RkNwaUE5LXJ6SEhuYU1uRHlqOFl2SU80dWFPZnJlUFpNOFV1NWZ6aHZrVWZPRjRndTdYYU9XR0R5RFZKbHBXeko2R1UzWDFkbG1jTmprRVk2NVR2Yzk2a1NhSHNjY1VPbTlWRjI0U2hPWF9vR0J3TzJGd1puMnhSNzR3NEVXcWFDa3pMVDIwdEZYLU5BcldNdm9sV0paNGNhVnBTem5NTGhoVGF3YlZ0dmtJN21kZEJ5V19tV0Y1Zm9KVmdoU3hEaW5RSzE4b052N2RPaHduZ0dCamltNV9zYWV1NnQzbEhiS3NRMGdDa1NERjJaVDRiRXF0aFJSNVcyel9ubHk2VVM4OFI3UVRwMmZOUG80Sk9LOUdoUGtDM2U0ZFNFdm90dk5OUWZLel84TjBaWmxsOXY2UFluamxqR2FGeW9EZ28wUjh6T3dsa1VqeGt3cmpsS01ZYzBLeVlMUU1xem0tZm9lR0lVTUlfYXIxNlVtY1Q0WE1tVUswZjJ6ZGJIVFdrTjd3QjJaUGVkUDVYSUR0VjlxYXpfSXVrOTlzT2l1c1gyc19lbkFBZjBhTFRaR0JTSVFkMzFFdlVSRElBZnJWV0h6YWhmaW9wUk5oaDBjU09KOTJ4R3U2U1dDWUZteVhibm02YlNZeUE5VldhSElqTUpPeFc2WmszNGVDMFB0WHlMbGE4Nll2MTlRRmpPdVlrdDJDVDRzQ2V0YnZJbWxJQnRUMFhZU3hBMGFfOWt6QkM2VUtKaGhyZi1OTExRU3NTS0IzMUh2NmlSR3NEb1EzSmxWNTJQTEM5Q091YXFHVFh2R0NwRjNESFY2ZjNZSEp2Vmt1SXJJWGZ2Q0x1TlhfbGV6YmJQT3pCWS1ZMUxWZk4wS0JNMmhBX0o5OXdIZ0RjVTdaNDhOYjM1a3ptZ0NjbWNIWWlkaXplUTM5VU1OOXlEd0hkb1I0UWM5UTNKSmJ4eTU3ZkZ3SU1ZbHpQZi1YOVlYTHFMVG4yR01JV1JXV2d1ZWhuamhfbnZ5cXBxakRSSTdvWVRZaVlidDNRVjVEQnZZZVk5MWFyalhJU2Mycl84TzNMeGpFSEpDYllLcGdzYk9raWhrSzJ3cllxZE1IVXZzSjR4QkFrc0Y1MzRfNXhLakd3bG1nbGdON09fNXlmODNMT05PMmdNNWJ6MXpOQ1dPSzQ0R0NLTzA0ZkhONjhZcjRpYTROLW5GWUVpZkE0RlRHUGxQRkhNbjZjS2VRSUtkTkxvRHd4TnJGYk1lVThZb0NTTEUwbGwyTlV4by1YZV9jZDJEQ3JzYTlSaXQxN01lUk4zNllMeXJnVTlwNjNrS1JVVm5wclgwVFB4dWRVd0Jscmh3a2JvNXhGTlAzejlIQWhrRFAwMlhUbDc0a1l2WWtHclRoTFdzUmVNbXB4UDVFMlJldGR5Q0dOVS1nSElUTi1fMWFyMjNSOVRES3dsZ0dyQzZ4dXZzR3JGVG9wZlBZRl9HQ2p2V3pkS19jeTV4NHRtZ0cyNTFQZnFscHBuS3ZsNzBmWTdsaDVqcW1HYjFHRDVMUDF3VnhfQ1B0RFF5eVd4bTRVdlR3Q1F0MzdYRXFXbXhzWjBiS0wyS1EzQnV2dElXQWMzMFNZM1FKVTh0cEJHcHpDakhNSnVSTVd5a2k4WUZXU3VJdFhDSTlYWXFtcXJFSGNxcXY3WTFGNzRMaE96VWZiYzdTU21ZTzdNUnRWd09KdHJiSjhlSEkySjRyNlJOU1FGNDBDQ0xreHFYdG5VQkdudlhCSzVVcHRieUtSOVdqOWlPUFUtYzdLS0NnRUtfZVJSa1EycGhzRkI3XzdXTE13R2VWQXp0WHoxcVVsbjhNdXB3aExxMXh4VmVDTlM5YmJMZkxRbHNTaUstcGo0QXZPMHZSZDRFZTkxRWRCODMxM2ZUUmVSa1JvSGI2UHMwNmNONi1VSzFjM2dqaENIeWtnUURFck1sdVhHVEkyZHMwbmI4MHMxdFg1RFZobFBlQmxYcVZYNHV3QTU4S1gzTEtNMExBMENIcGFmdTVaYW9FSEgySlRCSzhlNUo5bjN5aUtFeENLTXhQY0R2ZnFfQ1poWHNydDREY2tpbW9kNjVjYTY5R19KdFRZdnozRkktVno1UWh1RVJjRTZ5NHZFaHBMN2I0T1NVeXJ4dmFkdlFzNXRBM2poY3RZc3dINnJrQXJ0V1hVR25hLUtOcTJXSFduRVFONW4tZkVVNzFWam5aWjlyWkpkOWdsYi1xTW9ZSldiQWQtS25zVUdXdzdRUTdiWXU0ZGVJZXQ3bS1qMmZJYzRwcHhlRkExNk9NOU5jeWRFR1ZXd01aZU96ZGM4T2ZJOWpfY0NZTkhUVGlyb1JuM2JReE43VVk3WG1lY2d3eWp4V3RtY25LY1VJNGtXUGdEMmVYaFBaM3dQQ2dnMVpBMFl6bWZLSFdMLUhsaHl3VVlLWVZRY05kaUlpbENWTml3Q3VjcGVvM3FFRmxCcjFpOE9VNTZHTXUwa1ozZFVDdi0tX0ZNbTF0OTVTWDhEYkFaWGtFYjhQSlpyVXRxUXlNYkNYZzF0VEt4d1k4RlpvcEw3WTJTZVpvV1o4NDJLcGxERENGTmxKNWJWUF8xdjlvZFdrcHgyUm1GaUtNRTd5Z3dhbjlidEFtN09oY2lmVVFRQ0VIbTBDdHptNXdKbDhpak8tSDRiYksyQ2ttbzlTa3FjRzdmTk9lVXZTNDhFUGU1SVNlZ3lWam5zZjhINTNvTVVxY2todnpGeGZIZ1daY0tBNERaTXRZRGExbnVUWF96X2ZURnc5VVUxSU5MUEJMWUMyZXBQZmlBWWRnRHlCU3dQVWhDdnJmWVNxbEZRaVZXa3BneHQzNGp1MEUwR2tQNnlzSWxnN0lNaE1YNTA5X1N1MVp0SUNFYUp5VTVELWdKSUg4ZjJIb2tjTm1JTUg0R0lhWjdfUXQxWkxFb284b0hJM1E3eXZaYmJ5enNoRF9fOTBpdC1TeXBpWjlzS0JnZENvWEJkUC1yakhHSHdQUXlueTQzalltZko2aTV0ZU5zSlJ1aWp3S0VOdEhiNm4zUm9Fb1pJa2luWGxvcnNTRC1fTnN4Ump1VWt3STU1VldfNU40aU9wRktNbUV6RkQ1NGM0TVFja0g0eUpQbkNjNjRmMGtCTGV6c29FOXhqa3VvbzBadUNDVnRGUFZCWDJkd0tQdmV2ZWxQa0Vta1REVk16dFRQcnJoWnN6WXJNaW5HdnNVMVZDU2NCN0RRUGUwZ3RtRFhYRkNOR3JkbHMxdEtnNWQ2eTRVMnJYbEVwNW9pWjFPNUVPU3lkWVpFb09ZVWxHUTAzeXdkZUlzSjdyV0VsZkJaZ2JrZlVLUUtTX0tqRFRJdXFfZmhra09VdXkyYUI2azJvQjBrQzVJV3FaMXl1ZFppWjYxZkdBYTNESkRVLUNUNGxValZQclFHaFVJWTZtY1c1TFV5UmxsRzhRc0FPN2w5bXR5c2l4eVVQN3Zoa0YyeUdYeFgtMmR1bFhieEFjVVpMekViQVJLNjZ1dXI0WkZHNEpzLUE3VlNxWDhoR1RWNWpwbmpvenB0S01NQ3FtYU1wai01cXhZYjZfWjBTM3M4Um4ydEFCREhaWnl0STJjUXdPYWZRaUd6LTFKYmlfcWpxbDk5VDJJeG5aVTJ3bnYzb3d0SjJDVFFhSEFGVUdUUWJ4VEZXWFdpaVFhVDN1VWx0cTd1NEM1eTlIN1NFU0RVSDRpcGJDM0FFSDQxRW0taXVIdEFkcjhvWWRORHFDR2szNVc1RkdmV1BrTjdzanY3M1NCdGZsWnAyNjc3cVBtMWd0V0VDQXZyQ1lmQ0xOT2NtT21ud2dPTXhJblNCTWk1RHQ0YVd6M1VhMXBBVW9aYllWY29BZlloZlNwUzhsWU5vRUR0dnhUX19VWVRNMDZkQTVWOGVWWVk9)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmhELS1Fc2JwY3c5Y29fTmNwTzdhdFY1TjctV2FZTFI3SW9na0RoVXpkMkVlTG5MSlRSdGZDSHgwQVc2M09rSnMyV0dDaVR3MndmQ2hTYkk1NjEyanI4M1NnRkE9PQ==) # <-- Put your encrypted keystore password here
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmhELS1Fc2JwY3c5Y29fTmNwTzdhdFY1TjctV2FZTFI3SW9na0RoVXpkMkVlTG5MSlRSdGZDSHgwQVc2M09rSnMyV0dDaVR3MndmQ2hTYkk1NjEyanI4M1NnRkE9PQ==) # <-- Put your encrypted key alias password here
        FCI_KEY_ALIAS: upload1 # <-- Put your encrypted key alias here
        PACKAGE_NAME: "com.example.untitled" # <-- Put your package name here  
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up key properties
        script: |
          echo $FCI_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Set up local.properties
        script: |
          echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      - name: Flutter analyze
        script: |
          cd . && flutter analyze
      - name: Flutter unit tests
        script: |
          cd . && flutter test
        ignore_failure: true
      - name: Build APK with Flutter  
        script: |
          cd . && flutter build apk --release
    artifacts:
      - android/app/build/outputs/**/*.aab
      - build/**/outputs/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - kalgi@nevercode.io
        notify:
          success: true     # To not receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
