workflows:
  android-workflow:
    name: Android Workflow
    max_build_duration: 120
    environment:
      vars:
        FCI_KEYSTORE_PATH: /tmp/keystore.keystore
        FCI_KEYSTORE: Encrypted(Z0FBQUFBQmhFT2xjNnVmN1M5Q0QwM2o4ajllYW52RUNxdFlrWU9CZWl3a2w0V1NfSjQtTlZPQkFNcXFVbWRMZzRtX3FZeXlqZVJ4bUphZndjdzgwaWFnZWVPR0hGYjE1Z2tYV0RiUG51ZFhaX2hzanRWdl9GcjNwS2x6bW52Q2ZZR29ScG5EcU1Tb2lQY3FOQUpUWXhnY3JlMDhNNmU3NXlUWlBaV0pQOHFCSlBUclFMYjhLamJNTlVYcDlzSEtGc0FJbjhyM3otY1UxMUV1YkJXMW55VGk0ck9uWThzamlCMEpKUnBqRUJ5MHpUYWxDYjhNY04zcHNYWHQ4Y3gwWHlEdVFuZHM4eERIbUNLVlZ5QkQ5LTlta2RUejNvWkM1Z3pTYTlpTEJSYU5vZ0RxM3B4UmpRVXVOdVR1U0VjYldTWDRoS09rZWlWM0Ftb0RFSERQc1BQaFpCcVhUREVnVVRhRWszdzhGTGREaFpiN1Q4UVNuNklXR2c4RThieE12UHJ5VmwtMUdGbDFidmpNTlExVGhxMVU0V1ZNRmRwRDh1cnlIRW1OR1lVSGVsS2huUk9CZkxFYnNZc1N2dlhfMFBldDdoQzFUMXplSHhTVTUwS0NQV2FZbTdIenZXTHlJR1dnUVFjTC1STmY1ZU9MREp2MDI4SWt6c0NsNWxwS3BjbFdXaHhIWE1IaHd0RE1RUjcyS0YzWENVY20xbUx2MXFxbDFTVGQxbWd2VkRWTi0xdHRqN3ZEVmdyTE13ekwzMWpmalFFYTh3bk1oUll3MHAwbnRMOVg1X0tVSTNaUlNya2VhQ2NLcExfQ1BlNUtjS3FOOTZvOHJIWndpQU5GUW5sTGFHdzZBaGctbjZCV005MEl0SWQxcEpMUG91SGptYko0N0s2bGp4Y1dvTktCdzViMEM3NE1mWk04ay15N2t6RE8yeVFhQTBkT2lrR3ZFS2RBeldzLVFoWlp5a0ZNckVMZjFxemlsdXRxVU9tWF8wRW05VnVkcVVKYXJ6VnZoT3Z0VTNnekNwS0xaMDczOHJ4eVhmWVNOc2s5dlhFblVza0todzgwWlJkMHphaTMwRUJZTkMyamxKeFhRSEI2aV9hWU02VUVKekZPV0JyazNneVpTVHpzZnRRWnpRSC0tMkc3ZnFLLVA5N1B0QkZVQUZpeVdfUGQxb2dScHRJcnJ6dnZvWVNPTm9Gb0ltVHdhTFROU01LNWdhNWlhRHlaVVBaYmRpV1Q3MjU2NUk4dkhrbEU1TVdFc0xGSzlJTkVEVWw2UFEyN1BXVmFna3M5NjFTMGlJUzhLX0dyTmkzaE1LTTRzekQ2dk83TW5sYXRHcnJQNVBDZG1mT1NsTE1Qb3V5dng4VHRNQ2VONnl4U2dUajhXcDVCaWYzbXhfUmJiVkJuRTBOQWcwY1hQWXRfZUk5VTBlMXhoS2RBT3lvTlM0YW5GbzNqT3dybnVDSnpwcHlmajdld1VkWGZQX01jMjd2eG45SW0yekEwcWlpVHlrZnJHRE5oQ2VYWDk4ZjdPTER6TU42Q0FQZ3A0WGRhNnJFSDJPOWtiWWtwS2lZN0pMM3ZZdFJyMFgxUUpzTlZCSkdYdHBoTU9pY0JUZm5lMkY3MzlsUlo4VjAzd2pUMzJUZThRbUJEYm9LWHA4TXpxend5VjZGeDhzclcyd0lFTlVKU0VyVXVQODZ2Qy13cUFpTkNNQXpacXB3dC11UTJEOGk1ZU93TmpBaGNQZmF5dk9UUUl6aG93bW01bHNBa29EVFdmLUlTWW91TDRWdHpxVmlvbWpNaXpibHFheW1nSWM5NGl1N0xCV0tuTVJTWHhCRkRxS1Y5UFZIMU90V0lWR3JOUktqcllzd0M5YUhzU3VwYzdPT29YNHdybVdFZG1PQjF0T2lXSzVvUXpRS2czakY0ZDhCSGlUT0trbXRKRlN3b1hzZk1TVkd2SjY5b1FzZ0xseFR1Q1dVT1ljOVJ1OFFfdVB4aTY4Y3NQUnM3cXBhOU9hSER2cWlfazZQVFd6QjlXNnRzSmR2S21ZVmxHOV9PcDVVMFg3elU3VkhndHlrRW04ZUFleEs1VDdoMFFRSTJIT2pHUWpQLWl5bkhjZDBNT3VPNXFVcVc0Q29TV2hhYXlvZzVDQldpNjM3b2NJSjdFTTM2R1l2Mm5CN0NBdFhoYzBLNGI5UFVtVG45dTBJRkVwRFo1ZnY3Z0FZdTFmamZyWW5tLWVya2xfbkRuR1hDaGR4YlNhM0Fnd0JiX2g4X0JxOGdGRlk1S3hMdWVxWnI4NmhkMWNXRkN3RjQxaVQ3MW1VZWhMYjEtMm1aam9ZOEU5N0p3N0NMQVlCUEZ1aFk4ci15SVJ5ams5N3EyV1FGd1BOVjJVTjlrRkM0clNneDNOdm5KNHpVdm9HSmpFYkU5cENObWRxc3JJZUxQUGFwS3FRbDJrOF9FUEpNZjROS241SkVJbkthM01BTnEtTkNGQVNEdW8yVFRoRmlQdlpORW9jNmI4eG9RY0g3c2d6d2FDWURtNDNOVUYzcUR3dFQ1eFBUTnExMkZocjlPbkQxdzNZYzdvdFRmWGJnemhodTFKMG9obkRCdE5DclVEUjN5NV9zY0w0aHZuM2RRMHFhY2lSTUREaXVSSm5kYnBNNTZVM3FPLXdhZ002QWt3a1RFMTlMekdhV056LUJLak1tMDlDWmJEY3FTUFFvejhmTXZBX1MyeXVDd1NIcWpISXpNWU1xSjZyX0g5cWVnS1JLMXlaSnM1cm1fOGE2cl9FdXN2bDllUVVIQUF5SmFtbHRsd3dUS3U3dXpFLXFPVXZ1d0g2UHY4X3JDdUt1andkUjRxV21rR00wNnBHeG5jbDdXNmNoXy0tYWx1YmRnYnB6eWRrcW1RRTlJUERVdld1VF84bjFWSFdkb2lyVExHa2FfMzJHWGJxUE9yOWx2WHVYYUpxUXhkczdIZklLQV9icXlKb1RNMEpROFgtd0lKRTI2NGZvYlRBWG5oN1hzVVYyQmJlQ0lrOEdIMlpyYXdsRVJQZ2FSb2o5eHI4ei1EY2V5YVpnb01oQmVNOGtlYTQ5dFFMRzFRYzBIUmp3SjdNOERYSnhUbk1xdDB5WmFTMk9uakdoOFhOREhNbGRPbWc4WG1ldE9yQWJ0TnZWQUp5QTE1a21rM08wa2xnN2xJYjhseGhHODFpSjJXWk1SeWJSRzRwR1dTVC1UczdheDFhOXBoZ00xelRFU3RXb182ZlhocFY3dGhnQ1FZT3NNZlZjaHMxVlhzcFVPZExUWE42Tk1TQjJUOVI1SWN0N0pCQkU1ZlRUNGlWM3hjcktrYlZsTndyVXRGQjR3YnN6N3RJamdZRHBmcjFkN05idjkwWEZmS0tiT3ZZbEpBa0hfb2t4TzZqSmxGemRzODZONWJ6XzNwV1JlOC1yWFl5V3kzZzYyQWU1dUptckQ4NDMyRExMc0hoTHF0ZXpzOEE0REVZSmdZWmNCREtTNGJ4U0NpaENpcWNzbVpIc1ZwYVdYZGNZMVdxOEl0c1NXcjZ5dzJrU210NDl6NHY1XzlzZGhTLVdZVWhnS040UjVuam0zc2NMeC1IZHFsdG5ySU9IRkhWMF9UYzBIWWZfQkkxYVhrZHNlWkQ4MnJuTEN2b2hBMWQzUkpPX1VwWms2WDA2ejFHbERKbnk1Zy1mSTcxZWpyTmFkMVUtUVNGRGw2RGdhT2JhWERyTEhMc3pOaXVrOVNabEluRjVieWcyT1UzVnRYbE1wX1c1eDRDd2ZKNF9TN3I3YU9HRVVDUUNyQ0NTQWp3Y1JaYjdyUjFCNmlsMUpydkhRU2dpcDltUE43VndmeGozeUNsRDJQMC16cU5SSzNZYmh2UE5xcWstU3FOWDlxVVVxcEFKYng4N0NDYTUwMlpSeHNGNFVmVDl4eXQxbjM2T1BKNEN1MzNYVGRrRUhvNGRXR1RoMjZJNmJqZE5Tb2o1eGZyVGtHbVdSTDJsM2U5cUVqX3c5WElOcUFxS1k3UzNUUmRGdlFOeW05Skg5QW5QSm1yZF9zSEdhRFl5YzN2MWpxRF9NOUxFVFA2ZHhGNXlSWm5sYi1Gd2hNdlVYbWFheEt4dTVSNHRDWGlwWjNGa0NhTzdraVFQMHZhd1lLeWVObkVIVFNXd1FKci13ZmMyWWo0NGROY3ViNDN2aHZtcmE1ZG1qVlZOZlpVS1FnTXFaS2ZLX1hvYmJkN0lRMlZJYXZ5U0N0bVlqQ2JNZlRUeThVTGdHQ2gzTmVpcE05SWk2bEkweHpiV2R1WjluNkswQktpQVRvaHBwNDA5N2NTUUtiMndOM0NqTm1mTExqQ1lpSE1rZ09uS240Q3p1WDlGWWQwMFh4MG9wdHZoMUMwUW8yRWw0cGZHc3Y5ZkFoRU1QcmhtNFJ5VU1wT20xM2J4Tl9IaFFUV0s3S0dHdE1FeUVKTmloSnl4WEdFZUJJWDJOSzN4eTFfUWFidFgzcnJSNDZTMGxMRDRXeHlBeG5XRjBYNHp5NUthN1dFdmRxY3BmdDhzU08wRGhLUEQwMFRJcnhsWnI0QXFTM2F4QlF6ZER2Tjc1RmhZU19zd0Z0R2VZVUQzWDlOdndhQ1FfdU1wcnBwcGdNUGZvYkNFYnhkNUxPTURLbkh3eFczbFc2MTNtU0lmU1R2NzdIZGZMNFo3Nl9aQWxvS2NuSFVkRE5JNkpra1JrUzZVazZzZTQ4RkxIYUVZY2FraGU1WV9XeFVlbDlILU56VkZFeHlNZDg1M3RxLWc3NEZlMGNOZFhjbVhCaG1ScElPeXI4U2NxUHRMNXc0bnhjVHdYSVdKU05aMjk5bUZGRjhBRnFyUThvcnR5RW1KNTYwWU05UHQ3N3lhRmplY1RDcHo2YU16ZGw0bFZDbkJvY1cyaEQ4VWxxRVU5MWlScWVaNFlySU85bmNrWUs0REpRZXBHMFdvTlZqTjhiSW1ieE8wNWlnUzJjZm5vVEMzbkdqTFdJb2JjaUh2eHAyakNHOE4yWDVtNnhDM3FjRTdvdWRJbUp0YXpDX1JUZzItbjZwVUE0TGswTFlIT2JLdUR1YVYwOWdBbzRzdEk5eEoyLUdhUnZacEhBOURxZVhLSnlKUXFOWjNyb1ZJdTd2Y2s0WWNyb3ZQTkpyaXdpVnZIM3VRLXk5NjR1a3NOWHhzZGdvaVlmYTloYVJtdlhVbFpwakNfd0hPM0ZxcU1GS240c0c1WnlpU0VneDRucDhlSmhjWUZwajQ2NGU3WjI5Z0VfYkREclpNeFIwWjZScUVtaXJwR1lIb1BXOVUzS3pKYVE2MXc=)
        FCI_KEYSTORE_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_PASSWORD: Encrypted(Z0FBQUFBQmhFTjFwdHluYzhlTFc5cEw2Rkc2LXg5WVZfQnJTZEdHV1pHWllZQmdlMnAzdUdXdk5MMllPeEhmSXRMWUJZbXRNblIxY3dfUnhodmJMekVuNjNRZzNJaS16Qnc9PQ==)
        FCI_KEY_ALIAS: Encrypted(Z0FBQUFBQmhFTjJ1SzNnVW5TMElTWEdjcHc4ZDdNY09iREw5Z2JWejBtSmhzY0ViTjVodWxCYzloaHFEOXBxRGlMdDl6RDduV2NIcERab2UwRGNzc1FDU2pGS1NmM083SlE9PQ==) # <-- Put your encrypted key alias here
        PACKAGE_NAME: "com.example.untitled" # <-- Put your package name here  
      flutter: stable
      xcode: latest
      cocoapods: default
    scripts:
      - name: Set up key properties
        script: |
          echo $FCI_KEYSTORE | base64 --decode > /tmp/keystore.keystore
          cat >> "$FCI_BUILD_DIR/android/key.properties" <<EOF
          storePassword=$FCI_KEYSTORE_PASSWORD
          keyPassword=$FCI_KEY_PASSWORD
          keyAlias=$FCI_KEY_ALIAS
          storeFile=/tmp/keystore.keystore
          EOF
      - name: Set up local.properties
        script: |
          echo "flutter.sdk=$HOME/programs/flutter" > "$FCI_BUILD_DIR/android/local.properties"
      - name: Get Flutter packages
        script: |
          cd . && flutter packages pub get
      - name: Build AAB with Flutter  
        script: |
          cd . && flutter build appbundle --release      
    artifacts:
      - build/**/outputs/apk/**/*.apk
      - build/**/outputs/bundle/**/*.aab
      - build/**/outputs/**/mapping.txt
      - flutter_drive.log
    publishing:
      # See the following link for details about email publishing - https://docs.codemagic.io/publishing-yaml/distribution/#email
      email:
        recipients:
          - kalgi@nevercode.io
        notify:
          success: true     # To not receive a notification when a build succeeds
          failure: false    # To not receive a notification when a build fails
